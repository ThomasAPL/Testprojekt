{% extends "crm/base.html" %}
{% block title %}Adressen{% endblock %}
{% block content %}
  <div class="toolbar">
    <form method="get" class="inline">
      <input type="text" name="q" placeholder="Suche nach Name, Ort, E-Mail" value="{{ filter_q }}">
      <select name="type">
        <option value="">Alle Typen</option>
        {% for value,label in types %}
          <option value="{{ value }}" {% if value == filter_type %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      <button class="btn" type="submit">Filtern</button>
    </form>
    <div>
      <a class="btn btn-primary" href="{% url 'crm:address-create' %}">+ Neue Adresse</a>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Typ</th>
        <th>Ort</th>
        <th>Land</th>
        <th>Telefon</th>
        <th>E-Mail</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for a in addresses %}
        <tr>
          <td><a href="{% url 'crm:address-detail' a.pk %}">{{ a.name }}</a></td>
          <td class="muted">{{ a.get_type_display }}</td>
          <td>{{ a.postal_code }} {{ a.city }}</td>
          <td>{{ a.country }}</td>
          <td>{{ a.phone }}</td>
          <td><a href="mailto:{{ a.email }}">{{ a.email }}</a></td>
          <td><a href="{% url 'crm:address-update' a.pk %}">Bearbeiten</a></td>
        </tr>
      {% empty %}
        <tr><td colspan="7" class="muted">Keine Adressen gefunden.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  {% if is_paginated %}
    <p class="pagination">
      {% if page_obj.has_previous %}
        <a class="btn" href="?page={{ page_obj.previous_page_number }}&q={{ filter_q }}&type={{ filter_type }}">Zur√ºck</a>
      {% endif %}
      <span>Seite {{ page_obj.number }} von {{ paginator.num_pages }}</span>
      {% if page_obj.has_next %}
        <a class="btn" href="?page={{ page_obj.next_page_number }}&q={{ filter_q }}&type={{ filter_type }}">Weiter</a>
      {% endif %}
    </p>
  {% endif %}
{% endblock %}
